<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <script src="js/vue.js"></script>
    <script src="js/sockjs.min.js"></script>
    <script src="js/stomp.js"></script>
    <title>Title</title>
    <script src="../../../../../webpack-study/webpack.config.js"></script>
</head>
<body>

<div id="app">
    <input name="msg" v-model="msg" value=""/>
    <button @click="">发送消息</button>
    <button @click="linkToSocket()">接收消息</button>
</div>

<script>
    const wsHost = "http://localhost:8000/demo/endpoint"
    const wsTopic = "/topic/getMsg"


    new Vue({
        el: '#app',
        data: {
            msg: ''
        },
        methods: {
            linkToSocket() {
                let socket = new SockJS(wsHost)
                let stompClient = Stomp.over(socket);
                stompClient.connect({}, (frame) => {
                    console.log('websocket连接成功:' + frame);
                    // this.$message('websocket服务器连接成功');

                    // 另外再注册一下消息推送
                    stompClient.subscribe(wsTopic, (response) => {
                        console.log(response.body)
                        this.server = JSON.parse(response.body.data);
                    });
                })
            }
        }
    })
</script>
</body>
</html>